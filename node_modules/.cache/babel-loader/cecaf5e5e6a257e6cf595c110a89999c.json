{"ast":null,"code":"import { PLACE_ORDER } from \"./actionTypes\";\nimport { PLACE_ORDER_URL } from \"../../configs\";\nimport { APPLY_COUPON } from \"../coupon/actionTypes\";\nimport Axios from \"axios\";\nimport { updateCart } from \"../total/actions\";\nexport var placeOrder = function placeOrder(user, order, coupon, location, order_comment, total, method, payment_token, delivery_type, partial_wallet, distance, pending_payment) {\n  return function (dispatch, getState) {\n    return Axios.post(PLACE_ORDER_URL, {\n      token: user.data.auth_token,\n      user: user,\n      order: order,\n      coupon: coupon,\n      location: location,\n      order_comment: order_comment,\n      total: total,\n      method: method,\n      payment_token: payment_token,\n      delivery_type: delivery_type,\n      partial_wallet: partial_wallet,\n      dis: distance,\n      pending_payment: pending_payment\n    }).then(function (response) {\n      var checkout = response.data;\n\n      if (checkout.success) {\n        dispatch({\n          type: PLACE_ORDER,\n          payload: checkout\n        });\n        var state = getState(); // console.log(state);\n\n        var cartProducts = state.cart.products; // const user = state.user.user;\n\n        localStorage.removeItem(\"orderComment\");\n\n        for (var i = cartProducts.length - 1; i >= 0; i--) {\n          // remove all items from cart\n          cartProducts.splice(i, 1);\n        }\n\n        dispatch(updateCart(cartProducts));\n        localStorage.removeItem(\"appliedCoupon\");\n        var _coupon = [];\n        dispatch({\n          type: APPLY_COUPON,\n          payload: _coupon\n        });\n      } else {\n        return checkout;\n      }\n    }).catch(function (error) {\n      return error.response;\n    });\n  };\n};","map":{"version":3,"sources":["/opt/lampp/htdocs/shawarma/src/services/checkout/actions.js"],"names":["PLACE_ORDER","PLACE_ORDER_URL","APPLY_COUPON","Axios","updateCart","placeOrder","user","order","coupon","location","order_comment","total","method","payment_token","delivery_type","partial_wallet","distance","pending_payment","dispatch","getState","post","token","data","auth_token","dis","then","response","checkout","success","type","payload","state","cartProducts","cart","products","localStorage","removeItem","i","length","splice","catch","error"],"mappings":"AAAA,SAASA,WAAT,QAA4B,eAA5B;AACA,SAASC,eAAT,QAAgC,eAAhC;AACA,SAASC,YAAT,QAA6B,uBAA7B;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,kBAA3B;AAEA,OAAO,IAAMC,UAAU,GAAG,SAAbA,UAAa,CACzBC,IADyB,EAEzBC,KAFyB,EAGzBC,MAHyB,EAIzBC,QAJyB,EAKzBC,aALyB,EAMzBC,KANyB,EAOzBC,MAPyB,EAQzBC,aARyB,EASzBC,aATyB,EAUzBC,cAVyB,EAWzBC,QAXyB,EAYzBC,eAZyB;AAAA,SAarB,UAACC,QAAD,EAAWC,QAAX,EAAwB;AAC5B,WAAOhB,KAAK,CAACiB,IAAN,CAAWnB,eAAX,EAA4B;AAClCoB,MAAAA,KAAK,EAAEf,IAAI,CAACgB,IAAL,CAAUC,UADiB;AAElCjB,MAAAA,IAAI,EAAEA,IAF4B;AAGlCC,MAAAA,KAAK,EAAEA,KAH2B;AAIlCC,MAAAA,MAAM,EAAEA,MAJ0B;AAKlCC,MAAAA,QAAQ,EAAEA,QALwB;AAMlCC,MAAAA,aAAa,EAAEA,aANmB;AAOlCC,MAAAA,KAAK,EAAEA,KAP2B;AAQlCC,MAAAA,MAAM,EAAEA,MAR0B;AASlCC,MAAAA,aAAa,EAAEA,aATmB;AAUlCC,MAAAA,aAAa,EAAEA,aAVmB;AAWlCC,MAAAA,cAAc,EAAEA,cAXkB;AAYlCS,MAAAA,GAAG,EAAER,QAZ6B;AAalCC,MAAAA,eAAe,EAAEA;AAbiB,KAA5B,EAeLQ,IAfK,CAeA,UAACC,QAAD,EAAc;AACnB,UAAMC,QAAQ,GAAGD,QAAQ,CAACJ,IAA1B;;AAEA,UAAIK,QAAQ,CAACC,OAAb,EAAsB;AACrBV,QAAAA,QAAQ,CAAC;AAAEW,UAAAA,IAAI,EAAE7B,WAAR;AAAqB8B,UAAAA,OAAO,EAAEH;AAA9B,SAAD,CAAR;AAEA,YAAMI,KAAK,GAAGZ,QAAQ,EAAtB,CAHqB,CAIrB;;AACA,YAAMa,YAAY,GAAGD,KAAK,CAACE,IAAN,CAAWC,QAAhC,CALqB,CAMrB;;AACAC,QAAAA,YAAY,CAACC,UAAb,CAAwB,cAAxB;;AAEA,aAAK,IAAIC,CAAC,GAAGL,YAAY,CAACM,MAAb,GAAsB,CAAnC,EAAsCD,CAAC,IAAI,CAA3C,EAA8CA,CAAC,EAA/C,EAAmD;AAClD;AACAL,UAAAA,YAAY,CAACO,MAAb,CAAoBF,CAApB,EAAuB,CAAvB;AACA;;AAEDnB,QAAAA,QAAQ,CAACd,UAAU,CAAC4B,YAAD,CAAX,CAAR;AAEAG,QAAAA,YAAY,CAACC,UAAb,CAAwB,eAAxB;AACA,YAAM5B,OAAM,GAAG,EAAf;AACAU,QAAAA,QAAQ,CAAC;AAAEW,UAAAA,IAAI,EAAE3B,YAAR;AAAsB4B,UAAAA,OAAO,EAAEtB;AAA/B,SAAD,CAAR;AACA,OAnBD,MAmBO;AACN,eAAOmB,QAAP;AACA;AACD,KAxCK,EAyCLa,KAzCK,CAyCC,UAASC,KAAT,EAAgB;AACtB,aAAOA,KAAK,CAACf,QAAb;AACA,KA3CK,CAAP;AA4CA,GA1DyB;AAAA,CAAnB","sourcesContent":["import { PLACE_ORDER } from \"./actionTypes\";\r\nimport { PLACE_ORDER_URL } from \"../../configs\";\r\nimport { APPLY_COUPON } from \"../coupon/actionTypes\";\r\n\r\nimport Axios from \"axios\";\r\nimport { updateCart } from \"../total/actions\";\r\n\r\nexport const placeOrder = (\r\n\tuser,\r\n\torder,\r\n\tcoupon,\r\n\tlocation,\r\n\torder_comment,\r\n\ttotal,\r\n\tmethod,\r\n\tpayment_token,\r\n\tdelivery_type,\r\n\tpartial_wallet,\r\n\tdistance,\r\n\tpending_payment\r\n) => (dispatch, getState) => {\r\n\treturn Axios.post(PLACE_ORDER_URL, {\r\n\t\ttoken: user.data.auth_token,\r\n\t\tuser: user,\r\n\t\torder: order,\r\n\t\tcoupon: coupon,\r\n\t\tlocation: location,\r\n\t\torder_comment: order_comment,\r\n\t\ttotal: total,\r\n\t\tmethod: method,\r\n\t\tpayment_token: payment_token,\r\n\t\tdelivery_type: delivery_type,\r\n\t\tpartial_wallet: partial_wallet,\r\n\t\tdis: distance,\r\n\t\tpending_payment: pending_payment,\r\n\t})\r\n\t\t.then((response) => {\r\n\t\t\tconst checkout = response.data;\r\n\r\n\t\t\tif (checkout.success) {\r\n\t\t\t\tdispatch({ type: PLACE_ORDER, payload: checkout });\r\n\r\n\t\t\t\tconst state = getState();\r\n\t\t\t\t// console.log(state);\r\n\t\t\t\tconst cartProducts = state.cart.products;\r\n\t\t\t\t// const user = state.user.user;\r\n\t\t\t\tlocalStorage.removeItem(\"orderComment\");\r\n\r\n\t\t\t\tfor (let i = cartProducts.length - 1; i >= 0; i--) {\r\n\t\t\t\t\t// remove all items from cart\r\n\t\t\t\t\tcartProducts.splice(i, 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdispatch(updateCart(cartProducts));\r\n\r\n\t\t\t\tlocalStorage.removeItem(\"appliedCoupon\");\r\n\t\t\t\tconst coupon = [];\r\n\t\t\t\tdispatch({ type: APPLY_COUPON, payload: coupon });\r\n\t\t\t} else {\r\n\t\t\t\treturn checkout;\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\treturn error.response;\r\n\t\t});\r\n};\r\n"]},"metadata":{},"sourceType":"module"}