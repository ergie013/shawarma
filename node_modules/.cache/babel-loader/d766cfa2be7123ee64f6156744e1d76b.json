{"ast":null,"code":"import _classCallCheck from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/opt/lampp/htdocs/shawarma/src/components/Mobile/Account/Orders/RatingAndReview/index.js\";\nimport React, { Component } from \"react\";\nimport StarRatingComponent from \"react-star-rating-component\";\nimport { addRating, getOrderDetails } from \"../../../../../services/rating/actions\";\nimport { connect } from \"react-redux\";\nimport BackWithSearch from \"../../../Elements/BackWithSearch\";\nimport { Redirect } from \"react-router\";\nimport Loading from \"../../../../helpers/loading\";\nexport var RateAndReview =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(RateAndReview, _Component);\n\n  function RateAndReview() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, RateAndReview);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(RateAndReview)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      loading: true,\n      restaurant_rating: 0,\n      delivery_rating: 0,\n      comment: \"\",\n      order_id: _this.props.match.params.id,\n      user_id: \"\",\n      auth_token: \"\",\n      required_error: false,\n      completed: false\n    };\n\n    _this.onFoodRating = function (nextValue, prevValue, name) {\n      _this.setState({\n        restaurant_rating: nextValue\n      });\n    };\n\n    _this.onDeliveryRating = function (nextValue, prevValue, name) {\n      _this.setState({\n        delivery_rating: nextValue\n      });\n    };\n\n    _this.feedbackComment = function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        comment: event.target.value\n      });\n    };\n\n    _this.submitRating = function () {\n      if (_this.state.delivery_rating === 0 || _this.state.restaurant_rating === 0) {\n        _this.setState({\n          required_error: true\n        });\n      } else {\n        _this.props.addRating(_this.state);\n\n        _this.setState({\n          restaurant_rating: 0,\n          delivery_rating: 0,\n          comment: \"\"\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(RateAndReview, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.user.success) {\n        this.setState({\n          user_id: this.props.user.data.id,\n          auth_token: this.props.user.data.auth_token\n        });\n        this.props.getOrderDetails(this.props.match.params.id, this.props.user.data.id, this.props.user.data.auth_token);\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.rating_details !== nextProps.rating_details) {\n        if (nextProps.rating_details.success) {\n          this.setState({\n            loading: false\n          });\n        }\n\n        if (!nextProps.rating_details.success) {\n          console.log(\"Order not found\");\n          this.context.router.history.push(\"/\");\n        }\n      }\n\n      if (this.props.done_rating !== nextProps.done_rating) {\n        if (nextProps.done_rating.success) {\n          this.setState({\n            loading: false,\n            required_error: false,\n            completed: true\n          });\n          console.log(\"Rating done. Redirect to home\");\n          setTimeout(function () {// this.context.router.history.push(\"/\");\n          }, 5000);\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          restaurant_rating = _this$state.restaurant_rating,\n          delivery_rating = _this$state.delivery_rating;\n\n      if (window.innerWidth > 768) {\n        return React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93\n          },\n          __self: this\n        });\n      }\n\n      if (localStorage.getItem(\"storeColor\") === null) {\n        return React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        });\n      }\n\n      var user = this.props.user;\n\n      if (!user.success) {\n        return (//redirect to login page if not loggedin\n          React.createElement(Redirect, {\n            to: \"/login\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 102\n            },\n            __self: this\n          })\n        );\n      }\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, this.state.required_error && React.createElement(\"div\", {\n        className: \"auth-error mb-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"error-shake\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, \"Ratings are required\")), this.state.loading && React.createElement(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"col-12 p-0 mb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(BackWithSearch, {\n        boxshadow: true,\n        has_title: true,\n        title: localStorage.getItem(\"rarModRatingPageTitle\"),\n        disable_search: true,\n        goto_accounts_page: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      })), this.state.completed ? React.createElement(\"div\", {\n        className: \"d-flex justify-content-center pt-80\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"/assets/img/order-placed.gif\",\n        alt: \"Completed\",\n        className: \"img-fluid w-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      })) : React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"/assets/img/various/review-bg.png\",\n        alt: \"review\",\n        className: \"img-fluid review-screen-bg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"block-content block-content-full pt-80 px-15\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        className: \"rating-form\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group pt-30 mb-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"col-12 text-muted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, localStorage.getItem(\"rarModDeliveryRatingTitle\")), React.createElement(\"div\", {\n        className: \"col-md-9 pb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(StarRatingComponent, {\n        name: \"restaurant_rating\",\n        starCount: 5,\n        value: restaurant_rating,\n        onStarClick: this.onFoodRating,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"form-group mb-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"col-12 text-muted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, localStorage.getItem(\"rarModRestaurantRatingTitle\")), React.createElement(\"div\", {\n        className: \"col-md-9 pb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(StarRatingComponent, {\n        name: \"delivery_rating\",\n        starCount: 5,\n        value: delivery_rating,\n        onStarClick: this.onDeliveryRating,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"form-group mb-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"col-12 text-muted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, localStorage.getItem(\"rarReviewBoxTitle\")), React.createElement(\"div\", {\n        className: \"col-md-9 pb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(\"textarea\", {\n        placeholder: localStorage.getItem(\"rarReviewBoxTextPlaceHolderText\"),\n        value: this.state.comment,\n        onChange: this.feedbackComment,\n        className: \"feedback-textarea\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }))), React.createElement(\"button\", {\n        className: \"btn-fixed-bottom\",\n        style: {\n          backgroundColor: localStorage.getItem(\"storeColor\")\n        },\n        onClick: this.submitRating,\n        type: \"button\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, localStorage.getItem(\"rarSubmitButtonText\"))))));\n    }\n  }]);\n\n  return RateAndReview;\n}(Component);\nRateAndReview.contextTypes = {\n  router: function router() {\n    return null;\n  }\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.user,\n    rating_details: state.rating.rating_details,\n    done_rating: state.rating.done_rating\n  };\n};\n\nexport default connect(mapStateToProps, {\n  addRating: addRating,\n  getOrderDetails: getOrderDetails\n})(RateAndReview);","map":{"version":3,"sources":["/opt/lampp/htdocs/shawarma/src/components/Mobile/Account/Orders/RatingAndReview/index.js"],"names":["React","Component","StarRatingComponent","addRating","getOrderDetails","connect","BackWithSearch","Redirect","Loading","RateAndReview","state","loading","restaurant_rating","delivery_rating","comment","order_id","props","match","params","id","user_id","auth_token","required_error","completed","onFoodRating","nextValue","prevValue","name","setState","onDeliveryRating","feedbackComment","event","preventDefault","target","value","submitRating","user","success","data","nextProps","rating_details","console","log","context","router","history","push","done_rating","setTimeout","window","innerWidth","localStorage","getItem","backgroundColor","contextTypes","mapStateToProps","rating"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport StarRatingComponent from \"react-star-rating-component\";\r\nimport { addRating, getOrderDetails } from \"../../../../../services/rating/actions\";\r\nimport { connect } from \"react-redux\";\r\nimport BackWithSearch from \"../../../Elements/BackWithSearch\";\r\nimport { Redirect } from \"react-router\";\r\nimport Loading from \"../../../../helpers/loading\";\r\n\r\nexport class RateAndReview extends Component {\r\n\tstatic contextTypes = {\r\n\t\trouter: () => null,\r\n\t};\r\n\tstate = {\r\n\t\tloading: true,\r\n\t\trestaurant_rating: 0,\r\n\t\tdelivery_rating: 0,\r\n\t\tcomment: \"\",\r\n\t\torder_id: this.props.match.params.id,\r\n\t\tuser_id: \"\",\r\n\t\tauth_token: \"\",\r\n\t\trequired_error: false,\r\n\t\tcompleted: false,\r\n\t};\r\n\r\n\tonFoodRating = (nextValue, prevValue, name) => {\r\n\t\tthis.setState({ restaurant_rating: nextValue });\r\n\t};\r\n\r\n\tonDeliveryRating = (nextValue, prevValue, name) => {\r\n\t\tthis.setState({ delivery_rating: nextValue });\r\n\t};\r\n\r\n\tfeedbackComment = (event) => {\r\n\t\tevent.preventDefault();\r\n\t\tthis.setState({ comment: event.target.value });\r\n\t};\r\n\r\n\tsubmitRating = () => {\r\n\t\tif (this.state.delivery_rating === 0 || this.state.restaurant_rating === 0) {\r\n\t\t\tthis.setState({\r\n\t\t\t\trequired_error: true,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.props.addRating(this.state);\r\n\t\t\tthis.setState({\r\n\t\t\t\trestaurant_rating: 0,\r\n\t\t\t\tdelivery_rating: 0,\r\n\t\t\t\tcomment: \"\",\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (this.props.user.success) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tuser_id: this.props.user.data.id,\r\n\t\t\t\tauth_token: this.props.user.data.auth_token,\r\n\t\t\t});\r\n\r\n\t\t\tthis.props.getOrderDetails(\r\n\t\t\t\tthis.props.match.params.id,\r\n\t\t\t\tthis.props.user.data.id,\r\n\t\t\t\tthis.props.user.data.auth_token\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tif (this.props.rating_details !== nextProps.rating_details) {\r\n\t\t\tif (nextProps.rating_details.success) {\r\n\t\t\t\tthis.setState({ loading: false });\r\n\t\t\t}\r\n\t\t\tif (!nextProps.rating_details.success) {\r\n\t\t\t\tconsole.log(\"Order not found\");\r\n\t\t\t\tthis.context.router.history.push(\"/\");\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.props.done_rating !== nextProps.done_rating) {\r\n\t\t\tif (nextProps.done_rating.success) {\r\n\t\t\t\tthis.setState({ loading: false, required_error: false, completed: true });\r\n\t\t\t\tconsole.log(\"Rating done. Redirect to home\");\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t// this.context.router.history.push(\"/\");\r\n\t\t\t\t}, 5000);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { restaurant_rating, delivery_rating } = this.state;\r\n\t\tif (window.innerWidth > 768) {\r\n\t\t\treturn <Redirect to=\"/\" />;\r\n\t\t}\r\n\t\tif (localStorage.getItem(\"storeColor\") === null) {\r\n\t\t\treturn <Redirect to={\"/\"} />;\r\n\t\t}\r\n\t\tconst { user } = this.props;\r\n\t\tif (!user.success) {\r\n\t\t\treturn (\r\n\t\t\t\t//redirect to login page if not loggedin\r\n\t\t\t\t<Redirect to={\"/login\"} />\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t{this.state.required_error && (\r\n\t\t\t\t\t<div className=\"auth-error mb-50\">\r\n\t\t\t\t\t\t<div className=\"error-shake\">Ratings are required</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t{this.state.loading && <Loading />}\r\n\t\t\t\t<div className=\"col-12 p-0 mb-5\">\r\n\t\t\t\t\t<BackWithSearch\r\n\t\t\t\t\t\tboxshadow={true}\r\n\t\t\t\t\t\thas_title={true}\r\n\t\t\t\t\t\ttitle={localStorage.getItem(\"rarModRatingPageTitle\")}\r\n\t\t\t\t\t\tdisable_search={true}\r\n\t\t\t\t\t\tgoto_accounts_page={true}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t{this.state.completed ? (\r\n\t\t\t\t\t<div className=\"d-flex justify-content-center pt-80\">\r\n\t\t\t\t\t\t<img src=\"/assets/img/order-placed.gif\" alt=\"Completed\" className=\"img-fluid w-50\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tsrc=\"/assets/img/various/review-bg.png\"\r\n\t\t\t\t\t\t\talt=\"review\"\r\n\t\t\t\t\t\t\tclassName=\"img-fluid review-screen-bg\"\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<div className=\"block-content block-content-full pt-80 px-15\">\r\n\t\t\t\t\t\t\t<form className=\"rating-form\">\r\n\t\t\t\t\t\t\t\t<div className=\"form-group pt-30 mb-0\">\r\n\t\t\t\t\t\t\t\t\t<label className=\"col-12 text-muted\">\r\n\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"rarModDeliveryRatingTitle\")}\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"col-md-9 pb-5\">\r\n\t\t\t\t\t\t\t\t\t\t<StarRatingComponent\r\n\t\t\t\t\t\t\t\t\t\t\tname=\"restaurant_rating\"\r\n\t\t\t\t\t\t\t\t\t\t\tstarCount={5}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={restaurant_rating}\r\n\t\t\t\t\t\t\t\t\t\t\tonStarClick={this.onFoodRating}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"form-group mb-0\">\r\n\t\t\t\t\t\t\t\t\t<label className=\"col-12 text-muted\">\r\n\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"rarModRestaurantRatingTitle\")}\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"col-md-9 pb-5\">\r\n\t\t\t\t\t\t\t\t\t\t<StarRatingComponent\r\n\t\t\t\t\t\t\t\t\t\t\tname=\"delivery_rating\"\r\n\t\t\t\t\t\t\t\t\t\t\tstarCount={5}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={delivery_rating}\r\n\t\t\t\t\t\t\t\t\t\t\tonStarClick={this.onDeliveryRating}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"form-group mb-0\">\r\n\t\t\t\t\t\t\t\t\t<label className=\"col-12 text-muted\">\r\n\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"rarReviewBoxTitle\")}\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"col-md-9 pb-5\">\r\n\t\t\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={localStorage.getItem(\"rarReviewBoxTextPlaceHolderText\")}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.comment}\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={this.feedbackComment}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"feedback-textarea\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tclassName=\"btn-fixed-bottom\"\r\n\t\t\t\t\t\t\t\t\tstyle={{ backgroundColor: localStorage.getItem(\"storeColor\") }}\r\n\t\t\t\t\t\t\t\t\tonClick={this.submitRating}\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"rarSubmitButtonText\")}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t)}\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\nconst mapStateToProps = (state) => ({\r\n\tuser: state.user.user,\r\n\trating_details: state.rating.rating_details,\r\n\tdone_rating: state.rating.done_rating,\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\t{ addRating, getOrderDetails }\r\n)(RateAndReview);\r\n"]},"metadata":{},"sourceType":"module"}