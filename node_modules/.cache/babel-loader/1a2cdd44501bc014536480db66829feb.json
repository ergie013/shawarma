{"ast":null,"code":"import _classCallCheck from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/opt/lampp/htdocs/shawarma/src/components/Mobile/RunningOrder/Map/index.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { getDeliveryGuyGpsLocation } from \"../../../../services/Delivery/gpslocation/actions\";\nimport GoogleMaps from \"./GoogleMaps\";\n\nvar Map =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Map, _Component);\n\n  function Map() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Map);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Map)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      gps_latitude: null,\n      gps_longitude: null,\n      show_delivery_gps: false,\n      delivery_guy_latitude: null,\n      delivery_guy_longitude: null,\n      loopStarted: false\n    };\n\n    _this.__getDeliveryGuyLocationOnce = function () {\n      var getDeliveryGuyGpsLocation = new Promise(function (resolve) {\n        _this.props.getDeliveryGuyGpsLocation(_this.props.user.data.auth_token, _this.props.order_id);\n\n        resolve(\"done\");\n      });\n      getDeliveryGuyGpsLocation.then(function () {\n        _this.setState({\n          show_delivery_gps: true\n        });\n      });\n    };\n\n    _this.gettingGpsLocationInterval = 0;\n\n    _this.__getDeliveryGuyGpsLocationLoop = function () {\n      // console.log(\"This should be called only once\");\n      _this.setState({\n        loopStarted: true\n      });\n\n      _this.gettingGpsLocationInterval = setInterval(function () {\n        _this.props.getDeliveryGuyGpsLocation(_this.props.user.data.auth_token, _this.props.order_id);\n      }, 15 * 1000);\n    };\n\n    return _this;\n  }\n\n  _createClass(Map, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.orderstatus_id === 3 || this.props.orderstatus_id === 4) {\n        this.__getDeliveryGuyLocationOnce();\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.orderstatus_id === 3 || nextProps.orderstatus_id === 4) {\n        if (!this.state.loopStarted) {\n          this.__getDeliveryGuyGpsLocationLoop();\n        }\n      }\n\n      if (this.props.delivery_gps_location !== nextProps.delivery_gps_location) {\n        if (!this.state.show_delivery_gps) {\n          this.setState({\n            show_delivery_gps: true\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearInterval(this.gettingGpsLocationInterval);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      // console.log(\"LOOP STATUS: \", this.state.loopStarted);\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, React.createElement(GoogleMaps, {\n        restaurant_latitude: this.props.restaurant_latitude,\n        restaurant_longitude: this.props.restaurant_longitude,\n        show_delivery_gps: this.state.show_delivery_gps,\n        delivery_gps_location: this.props.delivery_gps_location,\n        deliveryLocation: this.props.deliveryLocation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Map;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.user,\n    delivery_gps_location: state.gps_location.get_delivery_guy_gps_location\n  };\n};\n\nexport default connect(mapStateToProps, {\n  getDeliveryGuyGpsLocation: getDeliveryGuyGpsLocation\n})(Map);","map":{"version":3,"sources":["/opt/lampp/htdocs/shawarma/src/components/Mobile/RunningOrder/Map/index.js"],"names":["React","Component","connect","getDeliveryGuyGpsLocation","GoogleMaps","Map","state","gps_latitude","gps_longitude","show_delivery_gps","delivery_guy_latitude","delivery_guy_longitude","loopStarted","__getDeliveryGuyLocationOnce","Promise","resolve","props","user","data","auth_token","order_id","then","setState","gettingGpsLocationInterval","__getDeliveryGuyGpsLocationLoop","setInterval","orderstatus_id","nextProps","delivery_gps_location","clearInterval","restaurant_latitude","restaurant_longitude","deliveryLocation","mapStateToProps","gps_location","get_delivery_guy_gps_location"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport { connect } from \"react-redux\";\r\nimport { getDeliveryGuyGpsLocation } from \"../../../../services/Delivery/gpslocation/actions\";\r\nimport GoogleMaps from \"./GoogleMaps\";\r\n\r\nclass Map extends Component {\r\n\tstate = {\r\n\t\tgps_latitude: null,\r\n\t\tgps_longitude: null,\r\n\t\tshow_delivery_gps: false,\r\n\t\tdelivery_guy_latitude: null,\r\n\t\tdelivery_guy_longitude: null,\r\n\t\tloopStarted: false,\r\n\t};\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (this.props.orderstatus_id === 3 || this.props.orderstatus_id === 4) {\r\n\t\t\tthis.__getDeliveryGuyLocationOnce();\r\n\t\t}\r\n\t}\r\n\r\n\t__getDeliveryGuyLocationOnce = () => {\r\n\t\tconst getDeliveryGuyGpsLocation = new Promise((resolve) => {\r\n\t\t\tthis.props.getDeliveryGuyGpsLocation(this.props.user.data.auth_token, this.props.order_id);\r\n\t\t\tresolve(\"done\");\r\n\t\t});\r\n\r\n\t\tgetDeliveryGuyGpsLocation.then(() => {\r\n\t\t\tthis.setState({ show_delivery_gps: true });\r\n\t\t});\r\n\t};\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tif (nextProps.orderstatus_id === 3 || nextProps.orderstatus_id === 4) {\r\n\t\t\tif (!this.state.loopStarted) {\r\n\t\t\t\tthis.__getDeliveryGuyGpsLocationLoop();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.props.delivery_gps_location !== nextProps.delivery_gps_location) {\r\n\t\t\tif (!this.state.show_delivery_gps) {\r\n\t\t\t\tthis.setState({ show_delivery_gps: true });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgettingGpsLocationInterval = 0;\r\n\t__getDeliveryGuyGpsLocationLoop = () => {\r\n\t\t// console.log(\"This should be called only once\");\r\n\r\n\t\tthis.setState({ loopStarted: true });\r\n\t\tthis.gettingGpsLocationInterval = setInterval(() => {\r\n\t\t\tthis.props.getDeliveryGuyGpsLocation(this.props.user.data.auth_token, this.props.order_id);\r\n\t\t}, 15 * 1000);\r\n\t};\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tclearInterval(this.gettingGpsLocationInterval);\r\n\t}\r\n\r\n\trender() {\r\n\t\t// console.log(\"LOOP STATUS: \", this.state.loopStarted);\r\n\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<GoogleMaps\r\n\t\t\t\t\trestaurant_latitude={this.props.restaurant_latitude}\r\n\t\t\t\t\trestaurant_longitude={this.props.restaurant_longitude}\r\n\t\t\t\t\tshow_delivery_gps={this.state.show_delivery_gps}\r\n\t\t\t\t\tdelivery_gps_location={this.props.delivery_gps_location}\r\n\t\t\t\t\tdeliveryLocation={this.props.deliveryLocation}\r\n\t\t\t\t/>\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tuser: state.user.user,\r\n\tdelivery_gps_location: state.gps_location.get_delivery_guy_gps_location,\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\t{ getDeliveryGuyGpsLocation }\r\n)(Map);\r\n"]},"metadata":{},"sourceType":"module"}