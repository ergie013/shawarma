{"ast":null,"code":"import _classCallCheck from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/opt/lampp/htdocs/shawarma/src/components/Mobile/Cart/CartCheckoutBlock/index.js\";\nimport React, { Component } from \"react\";\nimport DelayLink from \"../../../helpers/delayLink\";\nimport Ink from \"react-ink\";\nimport { Link } from \"react-router-dom\";\nimport { checkConfirmCart, checkCartItemsAvailability } from \"../../../../services/confirmCart/actions\";\nimport { connect } from \"react-redux\";\nimport { placeOrder } from \"../../../../services/checkout/actions\";\nimport { addProduct } from \"../../../../services/cart/actions\";\nimport { updateCart } from \"../../../../services/total/actions\";\n\nvar CartCheckoutBlock =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CartCheckoutBlock, _Component);\n\n  function CartCheckoutBlock() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CartCheckoutBlock);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CartCheckoutBlock)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      process_cart_loading: false\n    };\n\n    _this.processCart = function () {\n      var _this$props = _this.props,\n          handleProcessCartLoading = _this$props.handleProcessCartLoading,\n          checkCartItemsAvailability = _this$props.checkCartItemsAvailability,\n          cartProducts = _this$props.cartProducts,\n          addProduct = _this$props.addProduct,\n          updateCart = _this$props.updateCart,\n          checkConfirmCart = _this$props.checkConfirmCart,\n          handleItemsAvailability = _this$props.handleItemsAvailability;\n      handleProcessCartLoading(true);\n      checkCartItemsAvailability(cartProducts).then(function (response) {\n        handleProcessCartLoading(false);\n\n        _this.setState({\n          process_cart_loading: false\n        });\n\n        if (response && response.length) {\n          cartProducts.filter(function (_ref) {\n            var id = _ref.id;\n            return response.includes(id);\n          }).map(function (item) {\n            item.is_active = 0;\n            addProduct(item);\n            return item;\n          });\n          updateCart(_this.props.cartProducts);\n          handleItemsAvailability(false); //all items not available\n        } else {\n          cartProducts.map(function (item) {\n            item.is_active = 1;\n            addProduct(item);\n            return item;\n          });\n          updateCart(_this.props.cartProducts);\n          checkConfirmCart();\n\n          _this.context.router.history.push(\"/checkout\");\n        }\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(CartCheckoutBlock, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {// this.props.checkForItemsAvailability();\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      // const { checkout} = this.props;\n      if (nextProps.checkout !== this.props.checkout) {\n        //redirect to running order page\n        this.context.router.history.push(\"/running-order\");\n      } // console.log(\"NEXT PROPS - \" + nextProps.is_operational);\n      // if (nextProps.is_operational !== this.props.is_operational) {\n      //     console.log(\"Came here -> FROM CHILD\");\n      //     this.setState({ is_operational: false, loading: false });\n      // }\n\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      // console.log(\"LOADING - \" + this.state.loading);\n      var user = this.props.user;\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"bg-white cart-checkout-block\",\n        style: {\n          height: user.success && localStorage.getItem(\"userSelected\") === \"SELFPICKUP\" ? \"auto\" : \"22vh\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, user.success ? user.data.default_address == null ? React.createElement(\"div\", {\n        className: \"p-15\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"almost-there-text m-0 pb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, localStorage.getItem(\"cartSetYourAddress\")), React.createElement(DelayLink, {\n        to: \"/my-addresses\",\n        delay: 200,\n        className: \"btn btn-lg btn-continue\",\n        style: {\n          position: \"relative\",\n          backgroundColor: localStorage.getItem(\"storeColor\")\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, localStorage.getItem(\"buttonNewAddress\"), React.createElement(Ink, {\n        duration: 500,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }))) : React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, localStorage.getItem(\"userSelected\") === \"DELIVERY\" && React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"px-15 py-10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: {\n          pathname: \"/my-addresses\",\n          state: {\n            restaurant_id: this.props.restaurant_id\n          }\n        },\n        className: \"change-address-text m-0 p-5 pull-right\",\n        style: {\n          color: localStorage.getItem(\"storeColor\")\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, localStorage.getItem(\"cartChangeLocation\"), React.createElement(Ink, {\n        duration: 400,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      })), React.createElement(\"h2\", {\n        className: \"deliver-to-text m-0 pl-0 pb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, localStorage.getItem(\"cartDeliverTo\")), React.createElement(\"div\", {\n        className: \"user-address truncate-text m-0 pt-10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, user.data.default_address.address, user.data.default_address.house !== null && React.createElement(\"p\", {\n        className: \"truncate-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, user.data.default_address.house)))), React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, this.props.is_operational ? React.createElement(\"div\", {\n        style: {\n          marginTop: \"1.6rem\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        onClick: this.processCart,\n        className: \"btn btn-lg btn-make-payment\",\n        style: {\n          backgroundColor: localStorage.getItem(\"cartColorBg\"),\n          color: localStorage.getItem(\"cartColorText\"),\n          position: \"relative\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, localStorage.getItem(\"checkoutSelectPayment\"), React.createElement(Ink, {\n        duration: 400,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }))) : React.createElement(\"div\", {\n        className: \"auth-error bg-danger\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"error-shake\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, localStorage.getItem(\"cartRestaurantNotOperational\"))))) : React.createElement(\"div\", {\n        className: \"p-15\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"almost-there-text m-0 pb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, localStorage.getItem(\"cartLoginHeader\")), React.createElement(\"span\", {\n        className: \"almost-there-sub text-muted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, localStorage.getItem(\"cartLoginSubHeader\")), React.createElement(DelayLink, {\n        to: \"/login\",\n        delay: 200,\n        className: \"btn btn-lg btn-continue\",\n        style: {\n          backgroundColor: localStorage.getItem(\"storeColor\"),\n          position: \"relative\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, localStorage.getItem(\"cartLoginButtonText\"), React.createElement(Ink, {\n        duration: 500,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return CartCheckoutBlock;\n}(Component);\n\nCartCheckoutBlock.contextTypes = {\n  router: function router() {\n    return null;\n  }\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.user,\n    addresses: state.addresses.addresses,\n    cartProducts: state.cart.products,\n    cartTotal: state.total.data,\n    coupon: state.coupon.coupon,\n    checkout: state.checkout.checkout,\n    restaurant: state.restaurant\n  };\n};\n\nexport default connect(mapStateToProps, {\n  placeOrder: placeOrder,\n  checkConfirmCart: checkConfirmCart,\n  checkCartItemsAvailability: checkCartItemsAvailability,\n  addProduct: addProduct,\n  updateCart: updateCart\n})(CartCheckoutBlock);","map":{"version":3,"sources":["/opt/lampp/htdocs/shawarma/src/components/Mobile/Cart/CartCheckoutBlock/index.js"],"names":["React","Component","DelayLink","Ink","Link","checkConfirmCart","checkCartItemsAvailability","connect","placeOrder","addProduct","updateCart","CartCheckoutBlock","state","process_cart_loading","processCart","props","handleProcessCartLoading","cartProducts","handleItemsAvailability","then","response","setState","length","filter","id","includes","map","item","is_active","context","router","history","push","nextProps","checkout","user","height","success","localStorage","getItem","data","default_address","position","backgroundColor","pathname","restaurant_id","color","address","house","is_operational","marginTop","contextTypes","mapStateToProps","addresses","cart","products","cartTotal","total","coupon","restaurant"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport DelayLink from \"../../../helpers/delayLink\";\r\nimport Ink from \"react-ink\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { checkConfirmCart, checkCartItemsAvailability } from \"../../../../services/confirmCart/actions\";\r\nimport { connect } from \"react-redux\";\r\nimport { placeOrder } from \"../../../../services/checkout/actions\";\r\nimport { addProduct } from \"../../../../services/cart/actions\";\r\nimport { updateCart } from \"../../../../services/total/actions\";\r\n\r\nclass CartCheckoutBlock extends Component {\r\n\tstatic contextTypes = {\r\n\t\trouter: () => null,\r\n\t};\r\n\t// state = {\r\n\t//     loading: true,\r\n\t//     is_operational: true\r\n\t// };\r\n\r\n\tstate = {\r\n\t\tprocess_cart_loading: false,\r\n\t};\r\n\r\n\tcomponentDidMount() {\r\n\t\t// this.props.checkForItemsAvailability();\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\t// const { checkout} = this.props;\r\n\t\tif (nextProps.checkout !== this.props.checkout) {\r\n\t\t\t//redirect to running order page\r\n\t\t\tthis.context.router.history.push(\"/running-order\");\r\n\t\t}\r\n\t\t// console.log(\"NEXT PROPS - \" + nextProps.is_operational);\r\n\t\t// if (nextProps.is_operational !== this.props.is_operational) {\r\n\t\t//     console.log(\"Came here -> FROM CHILD\");\r\n\t\t//     this.setState({ is_operational: false, loading: false });\r\n\t\t// }\r\n\t}\r\n\r\n\tprocessCart = () => {\r\n\t\tconst {\r\n\t\t\thandleProcessCartLoading,\r\n\t\t\tcheckCartItemsAvailability,\r\n\t\t\tcartProducts,\r\n\t\t\taddProduct,\r\n\t\t\tupdateCart,\r\n\t\t\tcheckConfirmCart,\r\n\t\t\thandleItemsAvailability,\r\n\t\t} = this.props;\r\n\r\n\t\thandleProcessCartLoading(true);\r\n\r\n\t\tcheckCartItemsAvailability(cartProducts).then((response) => {\r\n\t\t\thandleProcessCartLoading(false);\r\n\t\t\tthis.setState({ process_cart_loading: false });\r\n\t\t\tif (response && response.length) {\r\n\t\t\t\tcartProducts\r\n\t\t\t\t\t.filter(({ id }) => response.includes(id))\r\n\t\t\t\t\t.map((item) => {\r\n\t\t\t\t\t\titem.is_active = 0;\r\n\t\t\t\t\t\taddProduct(item);\r\n\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t});\r\n\t\t\t\tupdateCart(this.props.cartProducts);\r\n\t\t\t\thandleItemsAvailability(false); //all items not available\r\n\t\t\t} else {\r\n\t\t\t\tcartProducts.map((item) => {\r\n\t\t\t\t\titem.is_active = 1;\r\n\t\t\t\t\taddProduct(item);\r\n\t\t\t\t\treturn item;\r\n\t\t\t\t});\r\n\t\t\t\tupdateCart(this.props.cartProducts);\r\n\t\t\t\tcheckConfirmCart();\r\n\t\t\t\tthis.context.router.history.push(\"/checkout\");\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\t// console.log(\"LOADING - \" + this.state.loading);\r\n\r\n\t\tconst { user } = this.props;\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName=\"bg-white cart-checkout-block\"\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\theight: user.success && localStorage.getItem(\"userSelected\") === \"SELFPICKUP\" ? \"auto\" : \"22vh\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{user.success ? (\r\n\t\t\t\t\t\tuser.data.default_address == null ? (\r\n\t\t\t\t\t\t\t<div className=\"p-15\">\r\n\t\t\t\t\t\t\t\t<h2 className=\"almost-there-text m-0 pb-5\">\r\n\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartSetYourAddress\")}\r\n\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t\t<DelayLink\r\n\t\t\t\t\t\t\t\t\tto=\"/my-addresses\"\r\n\t\t\t\t\t\t\t\t\tdelay={200}\r\n\t\t\t\t\t\t\t\t\tclassName=\"btn btn-lg btn-continue\"\r\n\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\tposition: \"relative\",\r\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: localStorage.getItem(\"storeColor\"),\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"buttonNewAddress\")}\r\n\t\t\t\t\t\t\t\t\t<Ink duration={500} />\r\n\t\t\t\t\t\t\t\t</DelayLink>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t{localStorage.getItem(\"userSelected\") === \"DELIVERY\" && (\r\n\t\t\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"px-15 py-10\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\tto={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpathname: \"/my-addresses\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstate: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trestaurant_id: this.props.restaurant_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"change-address-text m-0 p-5 pull-right\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: localStorage.getItem(\"storeColor\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartChangeLocation\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Ink duration={400} />\r\n\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t<h2 className=\"deliver-to-text m-0 pl-0 pb-5\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartDeliverTo\")}\r\n\t\t\t\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"user-address truncate-text m-0 pt-10\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{user.data.default_address.address}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{user.data.default_address.house !== null && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"truncate-text\">{user.data.default_address.house}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t\t{this.props.is_operational ? (\r\n\t\t\t\t\t\t\t\t\t\t<div style={{ marginTop: \"1.6rem\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.processCart}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-lg btn-make-payment\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: localStorage.getItem(\"cartColorBg\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: localStorage.getItem(\"cartColorText\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tposition: \"relative\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"checkoutSelectPayment\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Ink duration={400} />\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"auth-error bg-danger\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"error-shake\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartRestaurantNotOperational\")}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div className=\"p-15\">\r\n\t\t\t\t\t\t\t<h2 className=\"almost-there-text m-0 pb-5\">{localStorage.getItem(\"cartLoginHeader\")}</h2>\r\n\t\t\t\t\t\t\t<span className=\"almost-there-sub text-muted\">\r\n\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartLoginSubHeader\")}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<DelayLink\r\n\t\t\t\t\t\t\t\tto=\"/login\"\r\n\t\t\t\t\t\t\t\tdelay={200}\r\n\t\t\t\t\t\t\t\tclassName=\"btn btn-lg btn-continue\"\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tbackgroundColor: localStorage.getItem(\"storeColor\"),\r\n\t\t\t\t\t\t\t\t\tposition: \"relative\",\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartLoginButtonText\")}\r\n\t\t\t\t\t\t\t\t<Ink duration={500} />\r\n\t\t\t\t\t\t\t</DelayLink>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tuser: state.user.user,\r\n\taddresses: state.addresses.addresses,\r\n\tcartProducts: state.cart.products,\r\n\tcartTotal: state.total.data,\r\n\tcoupon: state.coupon.coupon,\r\n\tcheckout: state.checkout.checkout,\r\n\trestaurant: state.restaurant,\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\t{\r\n\t\tplaceOrder,\r\n\t\tcheckConfirmCart,\r\n\t\tcheckCartItemsAvailability,\r\n\t\taddProduct,\r\n\t\tupdateCart,\r\n\t}\r\n)(CartCheckoutBlock);\r\n"]},"metadata":{},"sourceType":"module"}