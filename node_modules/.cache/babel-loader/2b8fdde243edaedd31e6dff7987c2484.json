{"ast":null,"code":"import _regeneratorRuntime from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/lampp/htdocs/shawarma/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/opt/lampp/htdocs/shawarma/src/components/Delivery/index.js\";\nimport * as firebase from \"firebase/app\";\nimport React, { Component } from \"react\";\nimport Meta from \"../helpers/meta\";\nimport Orders from \"./Orders\";\nimport { Redirect } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport messaging from \"../../init-fcm\";\nimport { saveNotificationToken } from \"../../services/notification/actions\";\nimport ShareLiveLocation from \"./ShareLiveLocation\";\nimport DeliveryDesktop from \"./DeliveryDesktop\";\n\nvar Delivery =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Delivery, _Component);\n\n  function Delivery() {\n    _classCallCheck(this, Delivery);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Delivery).apply(this, arguments));\n  }\n\n  _createClass(Delivery, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var delivery_user, handler;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (document.querySelector(\"#mainManifest\")) {\n                  document.querySelector(\"#mainManifest\").setAttribute(\"href\", \"/delivery-manifest.json\");\n                }\n\n                if (document.getElementsByTagName(\"body\")) {\n                  document.getElementsByTagName(\"body\")[0].classList.add(\"bg-grey\");\n                }\n\n                delivery_user = this.props.delivery_user;\n\n                if (delivery_user.success) {\n                  if (firebase.messaging.isSupported()) {\n                    handler = this.props.saveNotificationToken;\n                    messaging.requestPermission().then(\n                    /*#__PURE__*/\n                    _asyncToGenerator(\n                    /*#__PURE__*/\n                    _regeneratorRuntime.mark(function _callee() {\n                      var push_token;\n                      return _regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              _context.next = 2;\n                              return messaging.getToken();\n\n                            case 2:\n                              push_token = _context.sent;\n                              handler(push_token, delivery_user.data.id, delivery_user.data.auth_token);\n\n                            case 4:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee, this);\n                    }))).catch(function (err) {\n                      console.log(\"Unable to get permission to notify.\", err);\n                    }); // navigator.serviceWorker.addEventListener(\"message\", message => console.log(message));\n                  }\n                }\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (window.innerWidth > 768) {\n        return React.createElement(DeliveryDesktop, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 46\n          },\n          __self: this\n        });\n      }\n\n      var delivery_user = this.props.delivery_user;\n\n      if (!delivery_user.success) {\n        return React.createElement(Redirect, {\n          to: \"/delivery/login\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 51\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54\n        },\n        __self: this\n      }, React.createElement(Meta, {\n        seotitle: \"Delivery Orders\",\n        seodescription: localStorage.getItem(\"seoMetaDescription\"),\n        ogtype: \"website\",\n        ogtitle: localStorage.getItem(\"seoOgTitle\"),\n        ogdescription: localStorage.getItem(\"seoOgDescription\"),\n        ogurl: window.location.href,\n        twittertitle: localStorage.getItem(\"seoTwitterTitle\"),\n        twitterdescription: localStorage.getItem(\"seoTwitterDescription\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      }), React.createElement(Orders, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }), React.createElement(ShareLiveLocation, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Delivery;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    delivery_user: state.delivery_user.delivery_user\n  };\n};\n\nexport default connect(mapStateToProps, {\n  saveNotificationToken: saveNotificationToken\n})(Delivery);","map":{"version":3,"sources":["/opt/lampp/htdocs/shawarma/src/components/Delivery/index.js"],"names":["firebase","React","Component","Meta","Orders","Redirect","connect","messaging","saveNotificationToken","ShareLiveLocation","DeliveryDesktop","Delivery","document","querySelector","setAttribute","getElementsByTagName","classList","add","delivery_user","props","success","isSupported","handler","requestPermission","then","getToken","push_token","data","id","auth_token","catch","err","console","log","window","innerWidth","localStorage","getItem","location","href","mapStateToProps","state"],"mappings":"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","sourcesContent":["import * as firebase from \"firebase/app\";\r\n\r\nimport React, { Component } from \"react\";\r\n\r\nimport Meta from \"../helpers/meta\";\r\nimport Orders from \"./Orders\";\r\n\r\nimport { Redirect } from \"react-router\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport messaging from \"../../init-fcm\";\r\nimport { saveNotificationToken } from \"../../services/notification/actions\";\r\nimport ShareLiveLocation from \"./ShareLiveLocation\";\r\nimport DeliveryDesktop from \"./DeliveryDesktop\";\r\n\r\nclass Delivery extends Component {\r\n\tasync componentDidMount() {\r\n\t\tif (document.querySelector(\"#mainManifest\")) {\r\n\t\t\tdocument.querySelector(\"#mainManifest\").setAttribute(\"href\", \"/delivery-manifest.json\");\r\n\t\t}\r\n\t\tif (document.getElementsByTagName(\"body\")) {\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"bg-grey\");\r\n\t\t}\r\n\r\n\t\tconst { delivery_user } = this.props;\r\n\r\n\t\tif (delivery_user.success) {\r\n\t\t\tif (firebase.messaging.isSupported()) {\r\n\t\t\t\tlet handler = this.props.saveNotificationToken;\r\n\t\t\t\tmessaging\r\n\t\t\t\t\t.requestPermission()\r\n\t\t\t\t\t.then(async function() {\r\n\t\t\t\t\t\tconst push_token = await messaging.getToken();\r\n\t\t\t\t\t\thandler(push_token, delivery_user.data.id, delivery_user.data.auth_token);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(function(err) {\r\n\t\t\t\t\t\tconsole.log(\"Unable to get permission to notify.\", err);\r\n\t\t\t\t\t});\r\n\t\t\t\t// navigator.serviceWorker.addEventListener(\"message\", message => console.log(message));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tif (window.innerWidth > 768) {\r\n\t\t\treturn <DeliveryDesktop />;\r\n\t\t}\r\n\t\tconst { delivery_user } = this.props;\r\n\r\n\t\tif (!delivery_user.success) {\r\n\t\t\treturn <Redirect to={\"/delivery/login\"} />;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Meta\r\n\t\t\t\t\tseotitle=\"Delivery Orders\"\r\n\t\t\t\t\tseodescription={localStorage.getItem(\"seoMetaDescription\")}\r\n\t\t\t\t\togtype=\"website\"\r\n\t\t\t\t\togtitle={localStorage.getItem(\"seoOgTitle\")}\r\n\t\t\t\t\togdescription={localStorage.getItem(\"seoOgDescription\")}\r\n\t\t\t\t\togurl={window.location.href}\r\n\t\t\t\t\ttwittertitle={localStorage.getItem(\"seoTwitterTitle\")}\r\n\t\t\t\t\ttwitterdescription={localStorage.getItem(\"seoTwitterDescription\")}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<Orders />\r\n\t\t\t\t<ShareLiveLocation />\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tdelivery_user: state.delivery_user.delivery_user,\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\t{ saveNotificationToken }\r\n)(Delivery);\r\n"]},"metadata":{},"sourceType":"module"}